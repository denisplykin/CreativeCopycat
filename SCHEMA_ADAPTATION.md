# üîÑ –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å—Ö–µ–º—É Supabase

## ‚úÖ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

–ü—Ä–æ–µ–∫—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ–¥ –≤–∞—à—É —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é —Å—Ö–µ–º—É –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

### –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—Ö–µ–º–µ –¥–∞–Ω–Ω—ã—Ö

#### –°—Ç–∞—Ä–∞—è —Å—Ö–µ–º–∞ (–±—ã–ª–æ):
```
creatives ‚Üí creative_analysis ‚Üí creative_variants
```

#### –ù–æ–≤–∞—è —Å—Ö–µ–º–∞ (—Ç–µ–ø–µ—Ä—å):
```
creatives (—Å–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–º analysis –∏ generated_*_url)
patterns (—à–∞–±–ª–æ–Ω—ã)
runs (–ª–æ–≥–∏ –∑–∞–ø—É—Å–∫–æ–≤)
```

### –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

#### 1. –¢–∞–±–ª–∏—Ü–∞ `creatives`
–¢–µ–ø–µ—Ä—å –≤–∫–ª—é—á–∞–µ—Ç –≤—Å—ë –≤ –æ–¥–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ:
- ‚úÖ `original_image_url` - URL –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–≤–º–µ—Å—Ç–æ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –ø—É—Ç–∏)
- ‚úÖ `analysis` (jsonb) - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞ –≤—Å—Ç—Ä–æ–µ–Ω—ã
- ‚úÖ `generated_character_url` - —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–µ—Ä—Å–æ–Ω–∞–∂
- ‚úÖ `generated_background_url` - —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–æ–Ω
- ‚úÖ `generated_image_url` - —Ñ–∏–Ω–∞–ª—å–Ω—ã–π –∫—Ä–µ–∞—Ç–∏–≤
- ‚úÖ `status` - workflow: pending ‚Üí analyzing ‚Üí generating ‚Üí completed/failed
- ‚úÖ `competitor_name` - –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞
- ‚úÖ `figma_file_id` - ID —Ñ–∞–π–ª–∞ Figma

#### 2. TypeScript —Ç–∏–ø—ã (`types/creative.ts`)
- ‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω `Creative` –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `AnalysisData` –¥–ª—è –ø–æ–ª—è analysis
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã `Pattern` –∏ `Run` –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
- ‚úÖ –£–¥–∞–ª–µ–Ω—ã —Å—Ç–∞—Ä—ã–µ `CreativeAnalysis` –∏ `CreativeVariant`

#### 3. Database –º–æ–¥—É–ª—å (`lib/db.ts`)
–ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- ‚úÖ `createCreative()` - —Å–æ–∑–¥–∞–Ω–∏–µ –∫—Ä–µ–∞—Ç–∏–≤–∞
- ‚úÖ `updateCreativeStatus()` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
- ‚úÖ `updateCreativeAnalysis()` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞ –≤ jsonb
- ‚úÖ `updateGeneratedUrls()` - —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ URL –≥–µ–Ω–µ—Ä–∞—Ü–∏–π
- ‚úÖ `getPatterns()` - —Ä–∞–±–æ—Ç–∞ —Å —à–∞–±–ª–æ–Ω–∞–º–∏
- ‚úÖ `createRun()` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—É—Å–∫–æ–≤
- ‚úÖ `getRecentRuns()` - –∏—Å—Ç–æ—Ä–∏—è –∑–∞–ø—É—Å–∫–æ–≤

#### 4. API Routes

**–û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ:**
- ‚úÖ `/api/creatives` - GET —Å–ø–∏—Å–æ–∫, POST —Å–æ–∑–¥–∞–Ω–∏–µ
- ‚úÖ `/api/creatives/[id]` - GET –æ–¥–∏–Ω –∫—Ä–µ–∞—Ç–∏–≤
- ‚úÖ `/api/analyze` - –∞–Ω–∞–ª–∏–∑ –∫—Ä–µ–∞—Ç–∏–≤–∞, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ analysis jsonb

**–ù–æ–≤—ã–µ:**
- ‚úÖ `/api/generate` - –µ–¥–∏–Ω—ã–π endpoint –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
  - `generationType`: 'character' | 'background' | 'full_creative'
  - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ `generated_*_url` –ø–æ–ª—è

**–£–¥–∞–ª—ë–Ω–Ω—ã–µ:**
- ‚ùå `/api/generate-copy` (–∑–∞–º–µ–Ω—ë–Ω –Ω–∞ `/api/generate`)
- ‚ùå `/api/generate-variation` (–∑–∞–º–µ–Ω—ë–Ω –Ω–∞ `/api/generate`)

#### 5. Storage Buckets

–û–±–Ω–∞—Ä—É–∂–µ–Ω—ã —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ buckets:
- ‚úÖ `creatives` - –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- ‚úÖ `backgrounds` - —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–æ–Ω—ã  
- ‚úÖ `assets` - –ø–µ—Ä—Å–æ–Ω–∞–∂–∏ –∏ –¥—Ä—É–≥–∏–µ –∞—Å—Å–µ—Ç—ã
- ‚úÖ `generated-creatives` - —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ –∫—Ä–µ–∞—Ç–∏–≤—ã

## üìä Workflow

### –°–æ–∑–¥–∞–Ω–∏–µ –∫—Ä–µ–∞—Ç–∏–≤–∞ –∞–≥–µ–Ω—Ç–æ–º:
```javascript
POST /api/creatives
{
  "original_image_url": "https://example.com/image.jpg",
  "competitor_name": "Nike"
}
// –°—Ç–∞—Ç—É—Å: pending
```

### –ê–Ω–∞–ª–∏–∑:
```javascript
POST /api/analyze
{
  "creativeId": "uuid"
}
// –°—Ç–∞—Ç—É—Å: analyzing ‚Üí analyzed
// –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø–æ–ª–µ analysis (jsonb)
```

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è:
```javascript
POST /api/generate
{
  "creativeId": "uuid",
  "generationType": "full_creative",
  "stylePreset": "anime"
}
// –°—Ç–∞—Ç—É—Å: generating ‚Üí completed
// –ó–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è generated_image_url
```

## üîç –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–ª—è `analysis` (jsonb)

```json
{
  "ocr": {
    "blocks": [...],
    "fullText": "..."
  },
  "layout": {
    "elements": [...],
    "canvasSize": { "width": 1080, "height": 1080 }
  },
  "roles": [
    { "role": "hook", "text": "..." },
    { "role": "cta", "text": "..." }
  ],
  "dominant_colors": ["#FF0000", "#00FF00"],
  "language": "en",
  "aspect_ratio": "1:1"
}
```

## üìù –¢–∞–±–ª–∏—Ü–∞ runs

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –∑–∞–ø—É—Å–∫–∏:
```json
{
  "run_id": "uuid",
  "input": { "creativeId": "...", "action": "analyze" },
  "output": { "analysis": {...} },
  "status": "success",
  "latency_ms": 1523,
  "created_at": "2024-..."
}
```

–ü–æ–ª–µ–∑–Ω–æ –¥–ª—è:
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –û—Ç–ª–∞–¥–∫–∏
- –ê–Ω–∞–ª–∏—Ç–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

## üöÄ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

‚úÖ **–°–æ–∑–¥–∞–Ω–∏–µ –∫—Ä–µ–∞—Ç–∏–≤–æ–≤** —á–µ—Ä–µ–∑ POST /api/creatives  
‚úÖ **–ê–Ω–∞–ª–∏–∑** —á–µ—Ä–µ–∑ POST /api/analyze  
‚úÖ **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è** —á–µ—Ä–µ–∑ POST /api/generate  
‚úÖ **–°—Ç–∞—Ç—É—Å—ã** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è  
‚úÖ **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** –≤ —Ç–∞–±–ª–∏—Ü—É runs  
‚úÖ **Storage** –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è  

## ‚ö†Ô∏è –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–¥–µ–ª–∞—Ç—å (UI)

UI —Å—Ç—Ä–∞–Ω–∏—Ü—ã –µ—â—ë –Ω–µ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω—ã. –ù—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å:
- `app/creatives/page.tsx` - –ø–æ–¥ –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É Creative
- `app/creatives/[id]/page.tsx` - –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å analysis –∏–∑ jsonb
- –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å generated_*_url

## üîß –ö–∞–∫ –∞–≥–µ–Ω—Ç—É –¥–æ–±–∞–≤–ª—è—Ç—å –∫—Ä–µ–∞—Ç–∏–≤—ã

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ API
```bash
curl -X POST https://your-app.vercel.app/api/creatives \
  -H "Content-Type: application/json" \
  -d '{
    "original_image_url": "https://example.com/ad.jpg",
    "competitor_name": "Nike"
  }'
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ù–∞–ø—Ä—è–º—É—é –≤ Supabase
```javascript
const { data, error } = await supabase
  .from('creatives')
  .insert({
    original_image_url: 'https://...',
    competitor_name: 'Nike',
    status: 'pending'
  });
```

## üì¶ Vercel –≥–æ—Ç–æ–≤ –∫ –¥–µ–ø–ª–æ—é

–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ Vercel —É—Å–ø–µ—à–Ω–æ —Å–æ–±–µ—Ä—ë—Ç –ø—Ä–æ–µ–∫—Ç:
1. ‚úÖ API endpoints –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å
2. ‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–∞
3. ‚úÖ Storage –Ω–∞—Å—Ç—Ä–æ–µ–Ω
4. ‚è≥ UI –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –æ–±–Ω–æ–≤–∏—Ç—å

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–µ–ø–ª–æ–π –≤ Vercel**
2. **–î–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π –∫—Ä–µ–∞—Ç–∏–≤** —á–µ—Ä–µ–∑ API
3. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –∞–Ω–∞–ª–∏–∑** —á–µ—Ä–µ–∑ POST /api/analyze
4. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é** —á–µ—Ä–µ–∑ POST /api/generate
5. **–û–±–Ω–æ–≤–∏—Ç–µ UI** –ø–æ–¥ –Ω–æ–≤—É—é —Å—Ö–µ–º—É (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

---

**–ê–¥–∞–ø—Ç–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –≤–∞—à–µ–π —Å—Ö–µ–º–æ–π –ë–î.** üéâ


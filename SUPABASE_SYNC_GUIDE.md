# üìä –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å Supabase

## üéØ –¶–µ–ª—å

–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ Google Sheets –≤ Supabase —Å **–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π** (4 –ø–æ–ª—è) –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤—Ç–æ—Ä—ã–º –∞–≥–µ–Ω—Ç–æ–º (–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞ –±–∞–∑–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–æ–≤).

## üìã –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

–í—Ç–æ—Ä–æ–º—É –∞–≥–µ–Ω—Ç—É –Ω—É–∂–Ω—ã —Ç–æ–ª—å–∫–æ 4 –ø–æ–ª—è:

```javascript
{
  image_url: "https://...",           // –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û: —Å—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–µ–≤—å—é
  competitor_name: "Kodland",        // –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞
  active_days: 45,                   // –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ (INTEGER)
  ad_id: "AD12345"                    // ID –∫—Ä–µ–∞—Ç–∏–≤–∞ (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä)
}
```

## üîÑ –°–∫—Ä–∏–ø—Ç—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### 1. sync-from-sheets.js

–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–∑ –æ–¥–Ω–æ–≥–æ –ª–∏—Å—Ç–∞ Google Sheets:

```bash
node sync-from-sheets.js
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ß–∏—Ç–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –ª–∏—Å—Ç–∞ (SHEET_ID)
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–æ–ª—å–∫–æ 4 –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª—è –≤ Supabase
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø–æ `ad_id` (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç) –∏–ª–∏ `image_url`
- –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏ –∏–ª–∏ —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–µ

### 2. sync-from-sheets-v2.js

–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–∑ –≤—Å–µ—Ö –ª–∏—Å—Ç–æ–≤ Google Sheets:

```bash
node sync-from-sheets-v2.js
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ –ª–∏—Å—Ç—ã –≤ —Ç–∞–±–ª–∏—Ü–µ
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ª–∏—Å—Ç–∞ ‚Üí –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ ‚Üí —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ Supabase
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–∞–∑–≤–∞–Ω–∏–µ –ª–∏—Å—Ç–∞ –∫–∞–∫ fallback –¥–ª—è `competitor_name`
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–æ–ª—å–∫–æ 4 –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª—è

## üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ saveCreative

–û—Ç–¥–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –∫—Ä–µ–∞—Ç–∏–≤–∞:

```javascript
const { saveCreative } = require('./lib/save-creative');

// –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
const rowData = {
  'Image URL': 'https://example.com/image.jpg',
  'Advertiser Name': 'Kodland',
  'Active Days': '45',
  'Ad ID': 'AD12345'
};

const result = await saveCreative(rowData);
console.log(result);
// { success: true, action: 'created', message: 'Created: AD12345' }
// –∏–ª–∏
// { success: true, action: 'updated', message: 'Updated: AD12345' }
```

## üìä –õ–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è

–°–∫—Ä–∏–ø—Ç—ã –ø—Ä–æ–≤–µ—Ä—è—é—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ —Å–ª–µ–¥—É—é—â–µ–º –ø–æ—Ä—è–¥–∫–µ:

1. **–ü–æ `ad_id`** (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω) - –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
2. **–ü–æ `image_url`** - fallback

–ï—Å–ª–∏ –∑–∞–ø–∏—Å—å –Ω–∞–π–¥–µ–Ω–∞ ‚Üí **–æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è**  
–ï—Å–ª–∏ –∑–∞–ø–∏—Å—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ ‚Üí **—Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤–∞—è**

## üîë –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Supabase

### URL –∏ Key

```javascript
const supabaseUrl = 'https://osokxlweresllgbclkme.supabase.co';
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...';
```

### –¢–∞–±–ª–∏—Ü–∞

**–¢–∞–±–ª–∏—Ü–∞:** `competitor_creatives`

**–ü–æ–ª—è:**
- `image_url` (TEXT, NOT NULL) - —Å—Å—ã–ª–∫–∞ –Ω–∞ –ø—Ä–µ–≤—å—é
- `competitor_name` (TEXT) - –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–∞
- `active_days` (INTEGER) - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π
- `ad_id` (TEXT) - ID –∫—Ä–µ–∞—Ç–∏–≤–∞

## üìù –ú–∞–ø–ø–∏–Ω–≥ –ø–æ–ª–µ–π –∏–∑ Google Sheets

| Google Sheets Column | Supabase Field | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ |
|---------------------|----------------|--------------|
| `Image URL` –∏–ª–∏ `Preview URL` | `image_url` | ‚úÖ –î–∞ |
| `Advertiser Name` –∏–ª–∏ `Competitor` | `competitor_name` | ‚ùå –ù–µ—Ç (fallback: "Unknown") |
| `Active Days` | `active_days` | ‚ùå –ù–µ—Ç (fallback: 0) |
| `Ad ID` –∏–ª–∏ `ID` | `ad_id` | ‚ùå –ù–µ—Ç (fallback: null) |

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã credentials

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞–ª–∏—á–∏–µ —Ñ–∞–π–ª–∞
ls service-account.json

# –ò–ª–∏ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
export GOOGLE_SERVICE_ACCOUNT_EMAIL="..."
export GOOGLE_PRIVATE_KEY="..."
```

### 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é

```bash
# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–∑ –æ–¥–Ω–æ–≥–æ –ª–∏—Å—Ç–∞
node sync-from-sheets.js

# –ò–ª–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–∑ –≤—Å–µ—Ö –ª–∏—Å—Ç–æ–≤
node sync-from-sheets-v2.js
```

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–°–∫—Ä–∏–ø—Ç—ã –≤—ã–≤–µ–¥—É—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:
```
üìä Sync Summary:
  ‚úÖ Updated: 150
  ‚ú® Created: 25
  ‚è≠Ô∏è  Skipped: 5
  ‚ùå Errors: 0
```

## üîç –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ Supabase

```bash
node test-sheets-connection.js
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Ç–∞–±–ª–∏—Ü—ã

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–∞–±–ª–∏—Ü–∞ `competitor_creatives` –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É:

```sql
CREATE TABLE IF NOT EXISTS competitor_creatives (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  image_url TEXT NOT NULL,
  competitor_name TEXT,
  active_days INTEGER DEFAULT 0,
  ad_id TEXT,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
CREATE INDEX IF NOT EXISTS idx_competitor_creatives_ad_id ON competitor_creatives(ad_id);
CREATE INDEX IF NOT EXISTS idx_competitor_creatives_image_url ON competitor_creatives(image_url);
CREATE INDEX IF NOT EXISTS idx_competitor_creatives_competitor_name ON competitor_creatives(competitor_name);
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **`image_url` –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω** - –∑–∞–ø–∏—Å–∏ –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –±—É–¥—É—Ç –ø—Ä–æ–ø—É—â–µ–Ω—ã
2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ `ad_id` –∏–º–µ–µ—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç** - –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω `ad_id`, –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏–¥–µ—Ç –ø–æ –Ω–µ–º—É
3. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π** - –µ—Å–ª–∏ –∑–∞–ø–∏—Å—å –Ω–∞–π–¥–µ–Ω–∞, –æ–Ω–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è (–Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è –¥—É–±–ª–∏–∫–∞—Ç)
4. **–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** - —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ 4 –ø–æ–ª—è, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `sync-from-sheets.js` - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–∑ –æ–¥–Ω–æ–≥–æ –ª–∏—Å—Ç–∞
- `sync-from-sheets-v2.js` - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–∑ –≤—Å–µ—Ö –ª–∏—Å—Ç–æ–≤
- `lib/save-creative.js` - —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–¥–Ω–æ–≥–æ –∫—Ä–µ–∞—Ç–∏–≤–∞
- `CREDENTIALS_SETUP.md` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Google Service Account credentials

---

**–ì–æ—Ç–æ–≤–æ!** –¢–µ–ø–µ—Ä—å –¥–∞–Ω–Ω—ã–µ –∏–∑ Google Sheets —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è –≤ Supabase —Å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ –∞–≥–µ–Ω—Ç–∞. üéâ

